=LAMBDA(array,LET(AUX,LAMBDA(SELF,working,nRow,iRow,IF(iRow=nRow,MAKEARRAY(nRow,nRow,LAMBDA(jRow,jCol,IF(AND(jRow=nRow,jCol=nRow),SQRT(INDEX(working,nRow,nRow)),IF(jRow=jCol,1,0)))),LET(a,INDEX(working,iRow,iRow),roota,SQRT(a),b,DROP(INDEX(working,0,iRow),iRow),scaledb,b/roota,lower,MAKEARRAY(nRow,nRow,LAMBDA(jRow,jCol,IF(jCol=iRow,IF(jRow>=iRow,INDEX(VSTACK(roota,scaledb),jRow-iRow+1),0),IF(jRow=jCol,1,0)))),lowerinv,MINVERSE(lower),working_,MMULT(MMULT(lowerinv,working),TRANSPOSE(lowerinv)),MMULT(lower,SELF(SELF,working_,nRow,iRow+1))))),IF(ROWS(array)=COLUMNS(array),AUX(AUX,array,ROWS(array),1),INDIRECT(""))))